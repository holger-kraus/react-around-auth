(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{20:function(e,t,a){e.exports=a.p+"static/media/logo-white.8f7611ae.svg"},22:function(e,t,a){e.exports=a.p+"static/media/success.e38b395c.svg"},23:function(e,t,a){e.exports=a.p+"static/media/failure.4072126c.svg"},26:function(e,t,a){e.exports=a(37)},31:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(19),i=a.n(o),l=a(7),c=(a(31),a(24)),s=a(1),u=a(2),m=a(20),d=a.n(m);var f=function(e){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{className:"header__logo",alt:"logo",src:d.a}),r.a.createElement("p",{className:"header__email"},e.loggedIn?e.email:""),r.a.createElement(l.b,{to:e.link.to,className:"header__link",onClick:e.onLogout?e.onLogout:null},e.link.description))};var _=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Holger Kraus"))},p=r.a.createContext({name:"Holger",about:"nothing"});var v=function(e){var t=r.a.useContext(p),a=e.card.owner._id===t._id,n="element__remove ".concat(a?"":"element__remove_hide"),o=e.card.likes.some((function(e){return e._id===t._id})),i="element__like-button ".concat(o?"element__like-button_liked":""),l=e.card.likes.length;return r.a.createElement("li",{className:"element","data-id":"#"},r.a.createElement("a",{className:"element__link",style:{backgroundImage:"url(".concat(e.card.link,")")},href:"#",onClick:function(){e.onCardClick(e.card)}},r.a.createElement("button",{className:n,onClick:function(t){t.stopPropagation(),t.preventDefault(),e.onCardDelete(e.card)}}),r.a.createElement("div",{className:"element__title-container"},r.a.createElement("h2",{className:"element__title"},e.card.name),r.a.createElement("div",{className:"element__like"},r.a.createElement("button",{className:i,onClick:function(t){t.stopPropagation(),t.preventDefault(),e.onCardLike(e.card)}}),r.a.createElement("span",{className:"element__like-count"},l)))))};var h=function(e){var t=r.a.useContext(p);return r.a.createElement("main",{className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("button",{className:"profile__avatar",onClick:e.onEditAvatar},r.a.createElement("img",{className:"profile__avatar-image",alt:"profile avatar",src:t.avatar}),r.a.createElement("div",{className:"profile__avatar-edit"})),r.a.createElement("div",{className:"profile__info"},r.a.createElement("h1",{className:"profile__name"},t.name),r.a.createElement("button",{className:"profile__edit-button",onClick:e.onEditProfile}),r.a.createElement("p",{className:"profile__about-me"},t.about)),r.a.createElement("button",{className:"profile__add-button",onClick:e.onAddPlace})),r.a.createElement("section",{className:"elements"},r.a.createElement("ul",{className:"elements__list"},e.cards.map((function(t,a){return r.a.createElement(v,{key:a,card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete})})))))};var b=function(e){var t=r.a.useRef(),a=r.a.useRef();return r.a.createElement("section",{className:"login"},r.a.createElement("form",{action:"#",className:"form form_authentication",onSubmit:function(n){n.preventDefault(),e.onSignin({email:t.current.value,password:a.current.value}),t.current.value="",a.current.value=""},noValidate:!0},r.a.createElement("h2",{className:"form__title form__title_authentication"},"Log in"),r.a.createElement("label",{className:"form__label form__label_authenticate-email",htmlFor:"login-email-input"},r.a.createElement("input",{ref:t,id:"login-email-input",type:"email",name:"name",className:"form__field form__field_authentication-email",placeholder:"Email",required:!0})),r.a.createElement("label",{htmlFor:"login-password-input",className:"form__label form__label_authenticate-password"},r.a.createElement("input",{ref:a,id:"login-password-input",type:"password",name:"aboutme",className:"form__field form__field_authentication-password",placeholder:"Password",required:!0})),r.a.createElement("button",{type:"submit",className:"form__save form__save_authenticate"},"Log in"),r.a.createElement(l.b,{to:"/signup",className:"form__save-hint"},"Not a member yet? Sign up here!")))};var g=function(e){var t=r.a.useRef(),a=r.a.useRef();return r.a.createElement("section",{className:"register"},r.a.createElement("form",{action:"#",className:"form form_authentication",onSubmit:function(n){n.preventDefault(),e.onSignup({email:t.current.value,password:a.current.value}),t.current.value="",a.current.value=""},noValidate:!0},r.a.createElement("h2",{className:"form__title form__title_authentication"},"Sign up"),r.a.createElement("label",{className:"form__label form__label_authenticate-email",htmlFor:"login-email-input"},r.a.createElement("input",{ref:t,id:"login-email-input",type:"email",name:"name",className:"form__field form__field_authentication-email",placeholder:"Email",required:!0})),r.a.createElement("label",{htmlFor:"login-password-input",className:"form__label form__label_authenticate-password"},r.a.createElement("input",{ref:a,id:"login-password-input",type:"password",name:"aboutme",className:"form__field form__field_authentication-password",placeholder:"Password",required:!0})),r.a.createElement("button",{type:"submit",className:"form__save form__save_authenticate"},"Sign up"),r.a.createElement(l.b,{to:"/signin",className:"form__save-hint"},"Already a member? Log in here!")))},E=a(25),k=function(e){e.component;var t=Object(E.a)(e,["component"]);return r.a.createElement(u.b,{exact:!0,path:t.path},(function(){return t.loggedIn?t.children:r.a.createElement(u.a,{to:"./signin"})}))};var y=function(e){var t=e.isOpen?"overlay_opened":"",a=e.isSubmitActive?"":"form__save_inactive";return r.a.createElement("section",{className:"overlay overlay_".concat(e.name," ").concat(t)},r.a.createElement("div",{className:"overlay__container overlay__container_".concat(e.name)},r.a.createElement("form",{action:"#",className:"form",noValidate:!0,onSubmit:e.onSubmit},r.a.createElement("h2",{className:"form__title"},e.title),e.children,r.a.createElement("button",{type:"submit",className:"form__save ".concat(a)},e.submitText)),r.a.createElement("button",{className:"overlay__close-button",onClick:e.onClose})))};var N=function(e){var t=r.a.useContext(p),a=Object(n.useState)(""),o=Object(s.a)(a,2),i=o[0],l=o[1],c=Object(n.useState)(null),u=Object(s.a)(c,2),m=u[0],d=u[1],f=Object(n.useState)(""),_=Object(s.a)(f,2),v=_[0],h=_[1],b=Object(n.useState)(""),g=Object(s.a)(b,2),E=g[0],k=g[1];r.a.useEffect((function(){l(t.name),h(t.about)}),[t]);var N=m?"form__field-error_active":"",O=E?"form__field-error_active":"",C=!N&&!O;return r.a.createElement(y,{name:"profile",title:"Edit profile",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:i,about:v})},isSubmitActive:C,submitText:e.submitText},r.a.createElement("label",{className:"form__label form__label_title",htmlFor:"profile-name-input"},r.a.createElement("input",{id:"profile-name-input",type:"text",name:"name",className:"form__field form__field_title",minLength:"2",maxLength:"40",pattern:"[a-zA-Z-\\s]*",value:i,onChange:function(e){l(e.target.value)},onInput:function(e){e.target.validity.valid?d(null):d(e.target.validationMessage)},required:!0}),r.a.createElement("span",{id:"profile-name-input-error",className:"form__field-error ".concat(N)},m)),r.a.createElement("label",{htmlFor:"profile-aboutme-input",className:"form__label form__label_detail"},r.a.createElement("input",{id:"profile-aboutme-input",type:"text",name:"aboutme",className:"form__field form__field_detail",minLength:"2",maxLength:"200",value:v,onChange:function(e){h(e.target.value)},onInput:function(e){e.target.validity.valid?k(null):k(e.target.validationMessage)},required:!0}),r.a.createElement("span",{id:"profile-aboutme-input-error",className:"form__field-error ".concat(O)},E)))};var O=function(e){var t=r.a.useRef(),a=Object(n.useState)(null),o=Object(s.a)(a,2),i=o[0],l=o[1],c=i?"form__field-error_active":"",u=!c;return r.a.createElement(y,{name:"avatarpic",title:"Change Userpic",isSubmitActive:u,isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},submitText:e.submitText},r.a.createElement("label",{className:"form__label form__label_title",htmlFor:"avatarpic-link-input"},r.a.createElement("input",{ref:t,id:"avatarpic-link-input",type:"url",name:"avatarpic-link",className:"form__field form__field_title",placeholder:"Image Link",onInput:function(e){e.target.validity.valid?l(null):l(e.target.validationMessage)},required:!0}),r.a.createElement("span",{id:"avatarpic-link-input-error",className:"form__field-error ".concat(c)},i)))};var C=function(e){var t=Object(n.useState)(""),a=Object(s.a)(t,2),o=a[0],i=a[1],l=Object(n.useState)(null),c=Object(s.a)(l,2),u=c[0],m=c[1],d=Object(n.useState)(""),f=Object(s.a)(d,2),_=f[0],p=f[1],v=Object(n.useState)(null),h=Object(s.a)(v,2),b=h[0],g=h[1],E=u?"form__field-error_active":"",k=b?"form__field-error_active":"",N=!E&&!k;return r.a.createElement(y,{name:"place",title:"New place",isOpen:e.isOpen,isSubmitActive:N,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onAddPlace({title:o,link:_})},submitText:e.submitText},r.a.createElement("label",{className:"form__label form__label_title",htmlFor:"place-title-input"},r.a.createElement("input",{id:"place-title-input",type:"text",name:"image-title",className:"form__field form__field_title",placeholder:"Title",minLength:"2",maxLength:"40",value:o,onChange:function(e){i(e.target.value)},onInput:function(e){e.target.validity.valid?m(null):m(e.target.validationMessage)},required:!0}),r.a.createElement("span",{id:"place-title-input-error",className:"form__field-error ".concat(E)},u)),r.a.createElement("label",{className:"form__label form__label_detail",htmlFor:"place-link-input"},r.a.createElement("input",{id:"place-link-input",type:"url",name:"image-link",className:"form__field form__field_detail",placeholder:"Image Link",value:_,onChange:function(e){p(e.target.value)},onInput:function(e){e.target.validity.valid?g(null):g(e.target.validationMessage)},required:!0}),r.a.createElement("span",{id:"place-link-input-error",className:"form__field-error ".concat(k)},b)))};var j=function(e){return r.a.createElement("section",{className:"overlay overlay_image ".concat(e.card?"overlay_opened":"")},r.a.createElement("div",{className:"overlay__container overlay__container_image"},r.a.createElement("img",{className:"image",alt:"image title",src:e.card&&e.card.link}),r.a.createElement("p",{className:"image__title"},e.card&&e.card.name),r.a.createElement("button",{className:"overlay__close-button",onClick:e.onClose})))};var S=function(e){return r.a.createElement(y,{name:"confirmation",title:"Are you sure?",isOpen:e.isOpen,isSubmitActive:!0,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onConfirmation(e.confirmedObject)},submitText:e.submitText})},w=a(22),P=a.n(w),x=a(23),L=a.n(x);var T=function(e){var t=e.success?"Success! You have now been registered.":"Oops, something went wrong! Please try again.",a=e.success?P.a:L.a;return r.a.createElement("section",{className:"overlay overlay_image ".concat(e.isOpen?"overlay_opened":"")},r.a.createElement("div",{className:"overlay__container overlay__container_message"},r.a.createElement("img",{src:a,className:"message__icon",alt:"image title"}),r.a.createElement("p",{className:"message__text"},t),r.a.createElement("button",{className:"overlay__close-button",onClick:e.onClose})))},U=a(12),I=a(13),R=new(function(){function e(t){Object(U.a)(this,e),this.baseUrl=t.baseUrl,this.headers=t.headers}return Object(I.a)(e,[{key:"getProfile",value:function(){var e=this.baseUrl.concat("/users/me");return this._getResource(e)}},{key:"updateProfile",value:function(e,t){var a=this.baseUrl.concat("/users/me"),n=JSON.stringify({name:e,about:t});return this._sendRequestWithBody(a,n,"PATCH")}},{key:"updateProfilePicture",value:function(e){var t=this.baseUrl.concat("/users/me/avatar"),a=JSON.stringify({avatar:e});return this._sendRequestWithBody(t,a,"PATCH")}},{key:"getInitialCards",value:function(){var e=this.baseUrl.concat("/cards");return this._getResource(e)}},{key:"addCard",value:function(e,t){var a=this.baseUrl.concat("/cards"),n=JSON.stringify({name:e,link:t});return this._sendRequestWithBody(a,n,"POST")}},{key:"changeLikeCardStatus",value:function(e,t){return t?this._addLike(e):this._deleteLike(e)}},{key:"deleteCard",value:function(e){var t=this.baseUrl.concat("/cards/").concat(e);return this._sendRequestWithoutBody(t,"DELETE")}},{key:"_addLike",value:function(e){var t=this.baseUrl.concat("/cards/likes/").concat(e);return this._sendRequestWithoutBody(t,"PUT")}},{key:"_deleteLike",value:function(e){var t=this.baseUrl.concat("/cards/likes/").concat(e);return this._sendRequestWithoutBody(t,"DELETE")}},{key:"_getResource",value:function(e){return fetch(e,{headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"_sendRequestWithoutBody",value:function(e,t){return fetch(e,{method:t,headers:this.headers}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"_sendRequestWithBody",value:function(e,t,a){return fetch(e,{method:a,headers:this.headers,body:t}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-1",headers:{Authorization:"cf0daf24-499f-4e4d-a691-bc6825f65b5e","Content-Type":"application/json"}}),q=new(function(){function e(t){Object(U.a)(this,e),this.baseUrl=t.baseUrl}return Object(I.a)(e,[{key:"signup",value:function(e,t){var a=this.baseUrl.concat("/signup"),n=JSON.stringify({email:e,password:t});return this._sendRequestWithBody(a,{"Content-Type":"application/json"},n,"POST")}},{key:"signin",value:function(e,t){var a=this.baseUrl.concat("/signin"),n=JSON.stringify({email:e,password:t});return this._sendRequestWithBody(a,{"Content-Type":"application/json"},n,"POST")}},{key:"getMyIdentity",value:function(e){var t=this.baseUrl.concat("/users/me"),a={"Content-Type":"application/json",Authorization:"Bearer ".concat(e)};return this._getResource(t,a)}},{key:"_getResource",value:function(e,t){return fetch(e,{headers:t}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}},{key:"_sendRequestWithBody",value:function(e,t,a,n){return fetch(e,{method:n,headers:t,body:a}).then((function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}))}}]),e}())({baseUrl:"https://register.nomoreparties.co"});var A=Object(u.h)((function(){var e=Object(n.useState)(!1),t=Object(s.a)(e,2),a=t[0],o=t[1],i=Object(n.useState)(!1),l=Object(s.a)(i,2),m=l[0],d=l[1],v=Object(n.useState)(!1),E=Object(s.a)(v,2),y=E[0],w=E[1],P=Object(n.useState)(!1),x=Object(s.a)(P,2),L=x[0],U=x[1],I=Object(n.useState)(!1),A=Object(s.a)(I,2),D=A[0],B=A[1],W=Object(n.useState)(!0),F=Object(s.a)(W,2),M=F[0],J=F[1],H=Object(n.useState)(null),z=Object(s.a)(H,2),V=z[0],K=z[1],Y=Object(n.useState)(null),Z=Object(s.a)(Y,2),$=Z[0],G=Z[1],Q=Object(n.useState)({}),X=Object(s.a)(Q,2),ee=X[0],te=X[1],ae=Object(n.useState)([]),ne=Object(s.a)(ae,2),re=ne[0],oe=ne[1],ie=Object(n.useState)(""),le=Object(s.a)(ie,2),ce=le[0],se=le[1],ue=Object(n.useState)(!1),me=Object(s.a)(ue,2),de=me[0],fe=me[1],_e=Object(n.useState)(null),pe=Object(s.a)(_e,2),ve=pe[0],he=pe[1],be=Object(u.g)();function ge(){K(null),w(!1),o(!1),d(!1),B(!1)}return r.a.useEffect((function(){R.getProfile().then((function(e){te(e)})).catch((function(e){console.log(e)}))}),[]),r.a.useEffect((function(){R.getInitialCards().then((function(e){var t=[];e.forEach((function(e){t.push(e)})),oe(t)})).catch((function(e){console.log(e)}))}),[]),r.a.useEffect((function(){console.log("tokenCheck");var e=localStorage.getItem("token");e&&q.getMyIdentity(e).then((function(e){e&&e.data&&(fe(!0),he(e.data.email),be.push("/"))})).catch((function(e){console.log(e)}))}),[]),r.a.createElement("div",{className:"page"},r.a.createElement(p.Provider,{value:ee},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/signin"},r.a.createElement(f,{loggedIn:de,email:ve,link:{description:"Sign up",to:"/signup"}}),r.a.createElement(b,{onSignin:function(e){var t=e.email,a=e.password;q.signin(t,a).then((function(e){e.token&&(fe(!0),localStorage.setItem("token",e.token),be.push("/"))})).catch((function(e){B(!0),J(!1)}))}})),r.a.createElement(u.b,{path:"/signup"},r.a.createElement(f,{loggedIn:de,email:ve,link:{description:"Log in",to:"/signin"}}),r.a.createElement(g,{onSignup:function(e){var t=e.email,a=e.password;console.log(t),console.log(a),q.signup(t,a).then((function(e){e&&e.data&&(B(!0),J(!0),fe(!0),he(e.data.email),be.push("/"))})).catch((function(e){B(!0),J(!1)}))}})),r.a.createElement(k,{path:"/",loggedIn:de},r.a.createElement(f,{loggedIn:de,email:ve,link:{description:"Log out",to:"#"},onLogout:function(){fe(!1),localStorage.removeItem("token"),be.push("/signin")}}),r.a.createElement(h,{cards:re,onEditProfile:function(){se("Save"),o(!0)},onAddPlace:function(){se("Create"),d(!0)},onEditAvatar:function(){se("Save"),w(!0)},onCardClick:function(e){K(e)},onCardLike:function(e){var t=e.likes.some((function(e){return e._id===ee._id}));R.changeLikeCardStatus(e._id,!t).then((function(t){var a=re.map((function(a){return a._id===e._id?t:a}));oe(a)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){G(e),se("Delete"),U(!0)}}))),r.a.createElement(_,null),r.a.createElement(N,{isOpen:a,submitText:ce,onClose:ge,onUpdateUser:function(e){var t=e.name,a=e.about;se("Saving..."),R.updateProfile(t,a).then((function(e){te(e),o(!1)})).catch((function(e){console.log(e)}))}}),r.a.createElement(C,{isOpen:m,submitText:ce,onClose:ge,onAddPlace:function(e){var t=e.title,a=e.link;se("Creating..."),R.addCard(t,a).then((function(e){oe([].concat(Object(c.a)(re),[e])),d(!1)})).catch((function(e){console.log(e)}))}}),r.a.createElement(O,{isOpen:y,submitText:ce,onClose:ge,onUpdateAvatar:function(e){var t=e.avatar;se("Saving..."),R.updateProfilePicture(t).then((function(e){te(e),w(!1)})).catch((function(e){console.log(e)}))}}),r.a.createElement(S,{isOpen:L,onClose:ge,onConfirmation:function(e){se("Deleting..."),R.deleteCard(e._id).then((function(){var t=re.filter((function(t){return t._id!==e._id}));oe(t),U(!1)})).catch((function(e){console.log(e)}))},confirmedObject:$,submitText:ce}),r.a.createElement(j,{card:V,onClose:ge}),r.a.createElement(T,{isOpen:D,success:M,onClose:ge})))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(l.a,{basename:"/react-around-auth"},r.a.createElement(A,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[26,1,2]]]);
//# sourceMappingURL=main.9516ad26.chunk.js.map